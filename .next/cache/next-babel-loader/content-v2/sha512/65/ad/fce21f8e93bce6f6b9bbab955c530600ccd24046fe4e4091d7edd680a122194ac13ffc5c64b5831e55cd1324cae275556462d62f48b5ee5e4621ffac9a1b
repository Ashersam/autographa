{"ast":null,"code":"import * as logger from '../logger';\n\nconst crypto = require('crypto'); //  generates random string of characters i.e salt\n\n\nconst randomString = length => {\n  logger.debug('hashing.js', 'Generating salt in randomString');\n  return crypto.randomBytes(Math.ceil(length / 2)).toString('hex')\n  /** convert to hexadecimal format */\n  .slice(0, length);\n  /** return required number of characters */\n}; //  Hash using algorithm sha512 and salt\n\n\nexport const hash = (password, salt) => {\n  logger.debug('hashing.js', 'Inside hash');\n  const hashed = crypto.createHmac('sha512', salt);\n  hashed.update(password);\n  const value = hashed.digest('hex');\n  logger.debug('hashing.js', 'Exiting from hash after hanshing the password');\n  return {\n    salt,\n    password: value\n  };\n};\nexport const HashPassword = userPassword => {\n  logger.debug('hashing.js', 'Inside HashPassword'); // Generate salt of length 16\n\n  const salt = randomString(16);\n  const passwordData = hash(userPassword, salt);\n  logger.debug('hashing.js', 'Exiting from HashPassword');\n  return passwordData;\n};","map":{"version":3,"sources":["/home/asherphilip/Documents/autographa/renderer/src/core/hashing.js"],"names":["logger","crypto","require","randomString","length","debug","randomBytes","Math","ceil","toString","slice","hash","password","salt","hashed","createHmac","update","value","digest","HashPassword","userPassword","passwordData"],"mappings":"AAAA,OAAO,KAAKA,MAAZ,MAAwB,WAAxB;;AAEA,MAAMC,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB,C,CAEA;;;AACA,MAAMC,YAAY,GAAIC,MAAD,IAAY;AAC/BJ,EAAAA,MAAM,CAACK,KAAP,CAAa,YAAb,EAA2B,iCAA3B;AACA,SAAOJ,MAAM,CACVK,WADI,CACQC,IAAI,CAACC,IAAL,CAAUJ,MAAM,GAAG,CAAnB,CADR,EAEJK,QAFI,CAEK,KAFL;AAEY;AAFZ,GAGJC,KAHI,CAGE,CAHF,EAGKN,MAHL,CAAP;AAGqB;AACtB,CAND,C,CAQA;;;AACA,OAAO,MAAMO,IAAI,GAAG,CAACC,QAAD,EAAWC,IAAX,KAAoB;AACtCb,EAAAA,MAAM,CAACK,KAAP,CAAa,YAAb,EAA2B,aAA3B;AACA,QAAMS,MAAM,GAAGb,MAAM,CAACc,UAAP,CAAkB,QAAlB,EAA4BF,IAA5B,CAAf;AACAC,EAAAA,MAAM,CAACE,MAAP,CAAcJ,QAAd;AACA,QAAMK,KAAK,GAAGH,MAAM,CAACI,MAAP,CAAc,KAAd,CAAd;AACAlB,EAAAA,MAAM,CAACK,KAAP,CAAa,YAAb,EAA2B,+CAA3B;AACA,SAAO;AACLQ,IAAAA,IADK;AAELD,IAAAA,QAAQ,EAAEK;AAFL,GAAP;AAID,CAVM;AAYP,OAAO,MAAME,YAAY,GAAIC,YAAD,IAAkB;AAC5CpB,EAAAA,MAAM,CAACK,KAAP,CAAa,YAAb,EAA2B,qBAA3B,EAD4C,CAE5C;;AACA,QAAMQ,IAAI,GAAGV,YAAY,CAAC,EAAD,CAAzB;AACA,QAAMkB,YAAY,GAAGV,IAAI,CAACS,YAAD,EAAeP,IAAf,CAAzB;AACAb,EAAAA,MAAM,CAACK,KAAP,CAAa,YAAb,EAA2B,2BAA3B;AACA,SAAOgB,YAAP;AACD,CAPM","sourcesContent":["import * as logger from '../logger';\n\nconst crypto = require('crypto');\n\n//  generates random string of characters i.e salt\nconst randomString = (length) => {\n  logger.debug('hashing.js', 'Generating salt in randomString');\n  return crypto\n    .randomBytes(Math.ceil(length / 2))\n    .toString('hex') /** convert to hexadecimal format */\n    .slice(0, length); /** return required number of characters */\n};\n\n//  Hash using algorithm sha512 and salt\nexport const hash = (password, salt) => {\n  logger.debug('hashing.js', 'Inside hash');\n  const hashed = crypto.createHmac('sha512', salt);\n  hashed.update(password);\n  const value = hashed.digest('hex');\n  logger.debug('hashing.js', 'Exiting from hash after hanshing the password');\n  return {\n    salt,\n    password: value,\n  };\n};\n\nexport const HashPassword = (userPassword) => {\n  logger.debug('hashing.js', 'Inside HashPassword');\n  // Generate salt of length 16\n  const salt = randomString(16);\n  const passwordData = hash(userPassword, salt);\n  logger.debug('hashing.js', 'Exiting from HashPassword');\n  return passwordData;\n};\n"]},"metadata":{},"sourceType":"module"}